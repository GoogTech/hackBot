The architecture : 

![](architecture_v2.png)